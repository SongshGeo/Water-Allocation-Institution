%! Author = songshgeo
%! Date = 2022/3/10

In the methodology section, we first utilize the descriptions of official documents following the two institutional shifts to abstract the interactions of SES into structures as organizational diagrams during different periods of time.
Next, we introduce the dataset we used here and employ the Principal Components Analysis (PCA) method to reduce the dimensionality of variables affecting the total water use.
We then estimate the net effects of the two institutional shifts on total water use, changing trends, and differences in the YRB's provinces using the Differenced Synthetic Control (DSC) method~\cite{arkhangelsky2021}.
Finally, we present the efficiency tests approach for the DSC model.
% Finally, for discussion, we developed a marginal benefit analysis based on identified SES structures to provide the observed pattern of water use changes with a theoretical interpretation.

\subsection{Portraying structures}\label{sec:structures}

An organizational diagram is widely used to depict SES structures by abstracting links and nodes from the real-world interactions~\cite{wang2022g,bodin2017a,kluger2020,guerrero2015}.
We apply the analysis of the organizational diagrams~\cite{bodin2017b} to portray SES structures by abstracting relationships between ecological units (river reaches), stakeholders (provinces), and the administrative unit at the basin scale (the Yellow River Conservancy Commission) into structural patterns from official documents.
We examined the official documents of the two institutional shifts (87-WAS and 98-UBR) to portray the organizational diagrams in this study~\cite{bodin2017a,kluger2020,guerrero2015}.
It is important to note that it can result in very different structures when basin-scale regulatory entity (YRCC) is responsible for river reach regulation, or have direct authority to interact with provincial units.

\subsection{Dataset and preprocessing}\label{sec:dataset}
The data of water consumption surveys conducted by the Ministry of Water Resources were taken as the observed values throughout the years.
Then, to estimate the water use of the YRB by assuming there were no effects from institutional shifts, we focused on variables from five categories (environmental, economic, domestic, and technological) water use factors. Their specific items and origins are listed in~\ref{secS2}~Table~\ref{tab:variables}.
Among the total $31$ data-accessible provinces (or regions) assigned quotas in the 87-WAS and the 98-UBR, we dropped Sichuan, Tianjin and Beijing (together, Jinji) because of their trivial water use from the YRB (see Table~\ref{tab:quota}).
% We then divided the dataset into a ``target group'' and a ``control group'', treating provinces involved in water quota as the target group $(n=8)$ and other provinces as the control group $(n=20)$ for applying the DSC.\\

Using the normalized data of all variables, we performed the PCA reduction to capture $89.63\%$ explained variance by $5$ principal components.
Previous study has proved that combining PCA and DSC can lead to a more robust causal inference~\cite{bayani2021}.
We first applied the Zero-Mean normalization (unit variance), as the variables' units are far different. Then, we apply PCA to the multi-year average of each province, using the Elbow method to decide the number of the principal components (\textit{Appendix~\nameref{secS2}~Figure\ref{fig:elbow}}).
Finally, we transform the dataset and input the dimensions-reduced output into the DSC model.

\subsection{Differenced Synthetic Control}\label{sec:DSC}

The Differenced Synthetic Control (DSC) method~\cite{arkhangelsky2021} is a tool we use to estimate how water use might have evolved if there had been no institutional shift.
Think of it as creating an alternate reality or a ``what-if'' scenario to compare with what actually happened~\cite{abadie2010, abadie2015, hill2021}.
The key idea behind this method is to evaluate the effects of policy changes that mainly affect certain units (in this case, the institutional shifts in the Yellow River Basin or YRB).
The method creates a ``synthetic'' version of the affected units by combining information from other similar but unaffected units. This ``synthetic'' version serves as a control group, which we can compare with the actual affected units.
The DSC method, therefore, is a powerful tool as it allows us to control for unobserved factors that can change over time, providing more robust results.

In practice, all treated units (i.e., provinces) were affected by institutional shifts in 1987 and 1998, each taken as the ``shifted'' time $t_0$ within two individually analyzed periods $T$: from 1979 to 1998; from 1987 to 2008.
We separately include each of the eight provinces in the YRB (see \textit{\nameref{sec:dataset}}) as individual treated units~\cite{abadie2021}.
Then, we consider the $J+1$ units observed in time periods $T = {1, 2, \ldots, t}$ where the remaining $J=20$ units represent untreated provinces from outside the YRB.
We define $T_0$ to represent the number of pre-treatment periods ($1,\ldots,t_0$) and $T_1$ the number post-treatment periods ($t_0, \ldots, T$), such that $T = T_0+ T_1$.
The treated unit is exposed to the institutional shift in every post-treatment period $T_1$, unaffected by the institutional shift in all preceding periods $T_0$.
Then, any weighted average of the control units is a synthetic control and can be represented by a ($J \times 1$) vector of weights $\mathbf{W} = (w_{1}, \ldots ,w_{J})$, with $w_j \in (0, 1)$.
Among them, by introduce a ($k \times k$) diagonal, matrix $\mathbf{V}$ that signifies the relative importance of each variable, the DSC method procedure for finding the optimal synthetic control ($\mathbf{W}$) is expressed as follows:

\begin{equation}
    \mathbf{W^{*}(V)}=\underset{\mathbf{W} \in \mathcal{W}}{\operatorname{minimize}}\left(\mathbf{X}_{\mathbf{1}}-\mathbf{X}_{\mathbf{0}} \mathbf{W}\right)^{\prime} \mathbf{V}\left(\mathbf{X}_{\mathbf{1}}-\mathbf{X}_{\mathbf{0}} \mathbf{W}\right)
\end{equation}

where $X_1$ is the pre-treatment average of each variable in the dataset for the treated unit, while $X_0$ is a ($k \times J$) containing the pre-treatment characteristics for each of the $J$ control units; $\mathbf{W}^{*}(V)$ is the vector of weights $\mathbf{W}$ that minimizes the difference between the pre-treatment characteristics of the treated unit and the synthetic control, given $\mathbf{V}$. That is, $\mathbf{W^{*}}$ depends on the choice of $\mathbf{V}$ â€“hence the notation $\mathbf{W*(V)}$. Therefore, we choose $\mathbf{V^{*}}$ to be the $\mathbf{V}$ that results in $\mathbf{W*(V)}$ that minimizes the following expression:

\begin{equation}
    \mathbf{V}^{*}=\underset{\mathbf{V} \in \mathcal{V}}{\operatorname{argmin}}\left(\mathbf{Z}_{1}-\mathbf{Z}_{0} \mathbf{W}^{*}(\mathbf{V})\right)^{\prime}\left(\mathbf{Z}_{1}-\mathbf{Z}_{0} \mathbf{W}^{*}(\mathbf{V})\right)
\end{equation}

That is the minimum difference between the water uses of treated units and the synthetic controls in the pre-treatment period, where $\mathbf{Z}_{1}$ is a matrix containing every observation of the water use for the treated unit in the pre-treatment period $T_0$.
Similarly, $\mathbf{Z}_{0}$ is a ($k \times T_0$) matrix contains the water use for each control unit in the pre-treatment period, and $k$ is the number of variables in the datasets.
The DSC method generalizes the difference-in-differences estimator and allows for time-varying individual-specific unobserved heterogeneity, with better robustness~\cite{billmeier2013, smith2015}.
In this study, we adopted the minimization by the ``Synthetic Control Methods'' Python library (version 1.1.17)~\cite{engelbrektson2023}.

\subsection{Validating results}\label{sec:robustness}

Two primary methods can be employed to validate the efficiency of the DSC approach.

Firstly, the reconstruction effect on inferred variables (water consumption here) before and after treatment (the interventions of 87-WAS and 98-UBR) can be compared.
If there are small gaps between the predicted and observed values before treatment, and a large gap after treatment, it indicates that the policy intervention's effect is apparent.
In this study, to determine whether the intervention effect is significant, the paired sample $T$ test is used to calculate statistics, comparing the model predictions and actual observation data in the periods before and after institutional interventions for both the 87-WAS in $1987$ and 98-UBR in $1998$.
A valid result would be one where a significant difference is observed after treatment but not before treatment. If this is not the case, it implies that the institutional changes were ineffective for the treated units.

Secondly, placebo tests are another common way to evaluate the effectiveness of synthetic control methods~\cite{abadie2010}.
Placebo units are selected from the control unit pool and substituted for the treated unit, applying the synthetic control method to the placebo unit using the same data and parameters as the treated unit.
If the synthetic control method is effective, there should be a clear difference between the placebo unit and the control unit since the placebo unit should not be affected by the intervention.
% Placebo tests can be used to assess the effectiveness of the synthetic control method and detect any bias or confounding factors in the analysis.
In this study, we adopt the placebo test step suggested by Abadie when proposing the synthetic control method~\cite{abadie2010} and utilize the Python library of the differential synthetic control method for the placebo test.
If the ratio of the root mean square error (see Equation~\ref{ch5:eq:RMSE}) in the pre-synthesis period is significantly higher for most provinces (again using the $T$ test to determine the significance of the difference) than the results of other placebo units, it would suggest that the Yellow River Basin was more significantly affected than most other provinces during the treatment periods ($1987$ and $1998$), i.e., more effective.

\begin{equation}
    \label{ch5:eq:RMSE}
    \text{RMSE} = \sqrt{\frac{1}{n}\sum_{i=1}^{n}{(y_i-\hat{y}_i)}^2}
\end{equation}

Where $n$ is the observed number, $y_i$ is the actual value, and $\hat{y}_i$ is the predicted value.

% \subsection{Marginal benefits analysis}\label{sec:model}
% To infer the mechanisms underlying the results, we developed an marginal benefits analysis based on marginal revenue to analyze how the institutional shift could have led to differences in water use.

% \begin{ass}
%     (Water-dependent production) Because of irreplaceably, water is assumed to be the only production function input with two production efficiency types.
% \end{ass}

% \begin{ass}
%     (Ecological cost allocation) Under the assumption that the ecology is a single entity for the whole basin, the water use cost is equally assigned to each province.
% \end{ass}

% \begin{ass}
%     (Multi-period settings) There are multiple settings periods with a constant discount factor for the expectation of future water use.
% \end{ass}

% Under the above-simplified assumptions, we demonstrate three cases -corresponding to the abstracted SES structures (Figure~\ref{fig:structure}~C), inference of how SES structure alters the expected marginal benefits and costs of provinces making decisions.
% As one of the possible interpretations for the causality between SES structure and institutional effects, the derivation of the model based on the above three assumptions can be found in \textit{Appendix~\nameref{secS4}}, and some simple model-based extensions are involved in \textit{Appendix~\nameref{secS5}}.
