%! Author = songshgeo
%! Date = 2022/3/10

% 为了量化制度变迁为黄河流域用水带来的影响，我们按附图1所示的技术路线执行了分析过程
To process the data, we use the Principal Components Analysis (PCA) method to reduce the dimensionality of variables affecting the total water use.
We then estimated the net effects of two institutional shifts on total water use, changing trends, and differences of the YRB's provinces, by Differenced Synthetic Control (DSC) method~\cite{arkhangelsky2021}.
Finally, for theoretical discussion, we developed a marginal benefit analysis based on identified SES structures to provide the observed pattern of water use changes with a theoretical interpretation.

\subsection{Portraying structures}\label{sec:structures}
% 制度结构关系抽象
A point-axis network type structure of SES is a widely used way to depict them by abstracting links and nodes~\cite{wang2022g,bodin2017a,kluger2020,guerrero2015}.
We apply the network approach~\cite{bodin2017b} to portray SES structures by abstracting relationships between ecological units (river reaches), stakeholders (provinces), and the administrative unit (the YRCC) into structural pattern from the official documents.
Empirical studies have suggested that such widespread pattern in SES are the key to the functioning of structures. The network-based approach is to abstract connections between entities into links and nodes~\cite{bodin2017a,kluger2020,guerrero2015}.
In this study, we examined the official documents of the two institutional shifts of concern (87-WAS and 98-UBR, see \textit{Appendix \nameref{secS1}} for details).
Besides the ecologically connected river reaches, the agents (provinces and the YRCC) are abstracted as nodes, and their required interactions regarding water use are summarized as links.
The 1987-WAS requires the YRCC to monitor each river's reach, while the 1998-UBR requires direct interactions (through water use licenses) between the YRCC and the provinces.
Therefore, we linked the YRCC unit to each ecological unit after 87-WAS and each province unit after the 98-UBR.\\
We tested whether focusing on SES structures rather than institutional details could reasonably explain the differences caused by institutional shifts in the YRB.\\

\subsection{Dataset and preprocessing}\label{sec:dataset}
We choose datasets and variables to compare on actual and estimated water use of the YRB.
The actual water uses are accessible in China’s provincial annual water consumption dataset from the National Water Resources Utilization Survey, whose details are accessible from Zhou (2020)~\cite{zhou2020}.
To estimate the water use of the YRB by assuming there were no effects from institutional shifts, we focused on variables from five categories (environmental, economic, domestic, and technological) water use factors. Their specific items and origins are listed in Table~\ref{tab:variables}.

Among the total $31$ data-accessible provinces (or regions) assigned quotas in the 87-WAS and the 98-UBR, we dropped Sichuan, Tianjin, and Beijing because of their trivial water use from the YRB (see \textit{Appendix}~Table~\ref{tab:quota}). We then divided the dataset into a ``target group'' and a ``control group'', treating provinces involved in water quota as the target group $(n=8)$ and other provinces as the control group $(n=20)$ for applying the DSC.

Using the normalized data of all variables, we performed the PCA reduction to capture $89.63\%$ explained variance by $5$ principal components \textit{Appendix~\nameref{secS2}}. Bayan had proved that combining PCA and DSC can raise the robustness of causal inference~\cite{bayani2021}. We first applied the Zero-Mean normalization (unit variance), as the variables' units are far different. Then, we apply PCA to the multi-year average of each province, using the Elbow method to decide the number of the principal components (\textit{Appendix~\nameref{secS2}~Figure~\ref{fig:elbow}}). Finally, we transform the dataset and input the dimensions-reduced output into the DSC model.


\subsection{Differenced Synthetic Control}\label{sec:DSC}
Using the Differenced Synthetic Control (DSC) method, we estimate water use without the effect of the institutional shift.
The DSC method is an effective identification strategy for estimating the net effect of historical events or policy interventions on aggregate units (such as cities, regions, and countries) by constructing a comparable control unit~\cite{abadie2010, abadie2015, hill2021}.
This approach enables us to establish a counterfactual basis for exploring the consequences and incentives related to policy changes.

This method aims to evaluate the effects of policy change that are not random across units but focuses on some of them (i.e., institutional shifts in the YRB here).
By re-weighting units to match the pre-trend for the treated and control units, the DSC method imputes post-treatment control outcomes for the treated units by constructing a synthetic version of the treated units equal to a convex combination of control units.
Therefore, the synthetic and actual version difference can be estimated as a net effect for a treated unit.

In practice, all treated units (i.e., provinces) were affected by institutional shifts in 1987 and 1998, each taken as the ``shifted'' time $t_0$ within two individually analyzed periods $T$: from 1979 to 1998; from 1987 to 2008.
We include each province in the YRB ($n=8$, see \textit{\nameref{sec:dataset}}) as the treated unit separately, as multiple treated units approach had been widely applied~\cite{abadie2021}.
Then, we consider the $J+1$ units observed in time periods $T = {1,2 \cdots , T}$ with the remaining $J=20$ units are untreated provinces from outside.
We define $T_0$ to represent the number of pre-treatment periods ($1,\ldots,t_0$) and $T_1$ the number post-treatment periods ($t_0, \ldots, T$), such that $T = T_0+ T_1$.
The treated unit is exposed to the institutional shift in every post-treatment period $T_0$, unaffected by the institutional shift in all preceding periods $T_1$.
Then, any weighted average of the control units is a synthetic control and can be represented by a ($J * 1$) vector of weights $\mathbf{W} = (w_{1}, \ldots ,w_{J})$, with $w_j \in (0, 1)$.
Among them, by introduce a ($k * k$) diagonal, matrix $\mathbf{V}$ that signifies the relative importance of each covariant, the DSC method procedure for finding the optimal synthetic control ($W$) is expressed as follows:

\begin{equation}
    \mathbf{W^{*}(V)}=\underset{\mathbf{W} \in \mathcal{W}}{\operatorname{minimize}}\left(\mathbf{X}_{\mathbf{1}}-\mathbf{X}_{\mathbf{0}} \mathbf{W}\right)^{\prime} \mathbf{V}\left(\mathbf{X}_{\mathbf{1}}-\mathbf{X}_{\mathbf{0}} \mathbf{W}\right)
\end{equation}

where $\mathbf{W}^{*}(V)$ is the vector of weights $\mathbf{W}$ that minimizes the difference between the pre-treatment characteristics of the treated unit and the synthetic control, given $\mathbf{V}$. That is, $\mathbf{W^{*}}$ depends on the choice of $\mathbf{V}$ –hence the notation $\mathbf{W*(V)}$. Therefore, we choose $\mathbf{V^{*}}$ to be the $\mathbf{V}$ that results in $\mathbf{W*(V)}$ that minimizes the following expression:

\begin{equation}
    \mathbf{V}^{*}=\underset{\mathbf{V} \in \mathcal{V}}{\operatorname{argmin}}\left(\mathbf{Z}_{1}-\mathbf{Z}_{0} \mathbf{W}^{*}(\mathbf{V})\right)^{\prime}\left(\mathbf{Z}_{1}-\mathbf{Z}_{0} \mathbf{W}^{*}(\mathbf{V})\right)
\end{equation}

That is the minimum difference between the outcome of the treated unit and the synthetic control in the pre-treatment period, where $\mathbf{Z}_{1}$ is a ($1*T_0$) matrix containing every observation of the outcome for the treated unit in the pre-treatment period. Similarly, let $\mathbf{Z}_{0}$ be a ($k * T_0$) matrix containing the outcome for each control unit in the pre-treatment period, and $k$ is the number of variables in the datasets.
The DSC method generalizes the difference-in-differences estimator and allows for time-varying individual-specific unobserved heterogeneity, with double robustness properties~\cite{billmeier2013, smith2015}.

\subsection{Robustness analysis}\label{sec:robustness}

There are two main methods to test the robustness of DSC.
First of all, the reconstruction effect on inferred variables (water consumption in this chapter) before and after treatment (the intervention of watershed water division policy in this chapter) can be compared. If there is a small gap between the model predicted value reconstructed before treatment and the actual observed value, and a large gap between the predicted value and observed value reconstructed after treatment, it indicates that the effect of policy intervention is very obvious.
In the study of this chapter, in order to judge whether the intervention effect is significant, the paired sample $T$ test is used to calculate statistics, and the model prediction and actual observation data in the early and late period of institutional intervention are respectively tested for the two institutional interventions of "August 7" water separation scheme in $1987$ and unified watershed scheduling in $1998$.
If $p$ value after policy intervention is less than the threshold value (the confidence level of 95\% is adopted in this chapter, that is, the threshold value is $0.05$), the original hypothesis $H_0$ that "there is no significant difference between the two" can be rejected, and it is believed that the institutional intervention has significantly changed the water consumption in this region.
If the significance level of $T$ test before institutional intervention is greater than the threshold value, it means that the DSC model successfully predicted the change of water consumption in this region over time before institutional intervention, and the fitting effect is good.

Second, placebo trials are another common way to evaluate the effectiveness of synthetic control methods.
In a placebo trial, a placebo unit selected from the control unit library is substituted for the treated unit, and a synthetic control method is applied to the placebo unit using the same data and parameters as the treated unit.
If the synthetic control method is effective, there should be a clear difference between the placebo unit and the control unit, since the placebo unit should not be affected by the intervention.
Placebo tests can be used to assess the effectiveness of the synthetic control method and detect any bias or confounding factors in the analysis.
In this study, the placebo test step \cite{abadie2010} suggested by Abadie when proposing the synthetic control method was adopted, and the Python library of the differential synthetic control method developed by Dmitry et al. was used for the placebo test. If the ratio of the root mean square error (see Equation \ref{ch5:eq:RMSE}) to the pre-synthesis period was significantly higher in most provinces (again using the $T$ test to determine the significance of the difference) than the results of other placebo units, it would suggest that the Yellow River basin was more affected than most other provinces during the regime treatment period ($1987$ and $1998$ years).

\begin{equation}
    \label{ch5:eq:RMSE}
    \text{RMSE} = \sqrt{\frac{1}{n}\sum_{i=1}^{n}{(y_i-\hat{y}_i)}^2}
\end{equation}

Where $n$ is the observed number, $y_i$ is the actual value, and $\hat{y}_i$ is the predicted value.

% \subsection{Marginal benefits analysis}\label{sec:model}
% To infer the mechanisms underlying the results, we developed an marginal benefits analysis based on marginal revenue to analyze how the institutional shift could have led to differences in water use.

% \begin{ass}
%     (Water-dependent production) Because of irreplaceably, water is assumed to be the only production function input with two production efficiency types.
% \end{ass}

% \begin{ass}
%     (Ecological cost allocation) Under the assumption that the ecology is a single entity for the whole basin, the water use cost is equally assigned to each province.
% \end{ass}

% \begin{ass}
%     (Multi-period settings) There are multiple settings periods with a constant discount factor for the expectation of future water use.
% \end{ass}

% Under the above-simplified assumptions, we demonstrate three cases -corresponding to the abstracted SES structures (Figure~\ref{fig:structure}~C), inference of how SES structure alters the expected marginal benefits and costs of provinces making decisions.
% As one of the possible interpretations for the causality between SES structure and institutional effects, the derivation of the model based on the above three assumptions can be found in \textit{Appendix~\nameref{secS4}}, and some simple model-based extensions are involved in \textit{Appendix~\nameref{secS5}}.
